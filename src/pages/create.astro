---
import Layout from "../layouts/Layout.astro";
import { supabase } from "../supabaseClient";

const { request } = Astro;
if (request.method === "POST") {
    const form = await request.formData();
    const email = form.get("email") as string;
    const password = form.get("password") as string;

    try {
        const { data } = await supabase.auth.signUp({
            email,
            password,
        });

        const { data: data2 } = await supabase.auth.signInWithPassword({
            email,
            password,
        });

        
        console.log({data, data2});
    } catch (e) {
        console.error(e);
    }
}
---

<Layout title="Create account">
    <h3>Create an account</h3>
    <form method="post">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" />
        <label for="password">Password</label>
        <input type="password" id="password" name="password" />
        <button type="submit">Submit</button>
    </form>
    <br/>
    <a href="/login">Login to an account</a>
</Layout>
